<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>World Explorer</title>
  <!-- CesiumJS -->
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.113/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.113/Build/Cesium/Widgets/widgets.css" rel="stylesheet" />

  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #8B0000, #2F1B1B);
      color: white;
      text-align: center;
    }
    section {
      display: none;
      padding: 20px;
    }
    section.active {
      display: block;
    }
    h1 {
      font-size: 2.5em;
      margin-bottom: 20px;
    }
    p {
      font-size: 1.1em;
      max-width: 600px;
      margin: auto;
      margin-bottom: 40px;
      line-height: 1.6;
    }
    button {
      background: #c0392b;
      border: none;
      padding: 12px 25px;
      font-size: 1em;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background: #e74c3c;
    }
    /* Cesium Map Styles */
    html, body, #cesiumContainer {
      width: 100%;
      height: 100%;
    }
    #cesiumContainer {
      height: 90vh;
    }
    #searchBar {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      color: black;
      padding: 10px 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
      z-index: 10;
      display: flex;
      gap: 10px;
      align-items: center;
    }
    #searchInput {
      width: 300px;
      padding: 8px;
      font-size: 1em;
    }
    #infoBox {
      position: absolute;
      bottom: 20px;
      left: 20px;
      width: 300px;
      background: rgba(255,255,255,0.95);
      color: black;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      font-size: 0.9em;
      z-index: 10;
      display: none;
    }
    #loadingStatus {
      position: absolute;
      top: 80px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      z-index: 10;
      display: none;
    }
  </style>
</head>
<body>

  <!-- الصفحة الرئيسية -->
  <section id="home" class="active">
    <h1>Search for any place or landmark in the world,<br>and we’ll show it to you with information about it.</h1>
    <button onclick="showSection('map')">Let's Start</button>
    <br><br>
    <button onclick="showSection('privacy')">Privacy Policy</button>
  </section>

  <!-- صفحة الخريطة -->
  <section id="map">
    <div id="cesiumContainer"></div>
    <div id="searchBar">
      <input type="text" id="searchInput" placeholder="Enter a city, country or landmark name">
      <button onclick="searchLocation()">Search</button>
      <button onclick="showSection('home')">Back</button>
    </div>
    <div id="loadingStatus">Loading map...</div>
    <div id="infoBox"></div>
  </section>

  <!-- صفحة سياسة الخصوصية -->
  <section id="privacy">
    <h1>Privacy Policy</h1>
    <p>
      This website does not collect or store any personal information.
      No tracking or analytics services are used. Your activity stays private.
    </p>
    <button onclick="showSection('home')">Back to Home</button>
  </section>

  <script>
    function showSection(id) {
      document.querySelectorAll("section").forEach(sec => sec.classList.remove("active"));
      document.getElementById(id).classList.add("active");
      if (id === "map" && !window.mapLoaded) {
        loadMap();
      }
    }

    function loadMap() {
      window.mapLoaded = true;
      try {
        window.viewer = new Cesium.Viewer('cesiumContainer', {
          imageryProvider: new Cesium.UrlTemplateImageryProvider({
            url: 'https://tile.openstreetmap.org/{z}/{x}/{y}.png'
          }),
          baseLayerPicker: false,
          timeline: false,
          animation: false,
          shouldAnimate: true
        });
        viewer.scene.globe.enableLighting = false;
      } catch (error) {
        alert("Failed to load the Cesium map. Please check your connection.");
        console.error(error);
      }
    }

    async function searchLocation() {
      const query = document.getElementById("searchInput").value.trim();
      const infoBox = document.getElementById("infoBox");
      const loadingStatus = document.getElementById("loadingStatus");
      if (!query) return;
      loadingStatus.style.display = "block";
      loadingStatus.textContent = "Loading map...";
      try {
        const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}`;
        const res = await fetch(url);
        const data = await res.json();
        if (!data.length) {
          loadingStatus.textContent = `Location not found: ${query}`;
          infoBox.style.display = "none";
          return;
        }
        const lat = parseFloat(data[0].lat);
        const lon = parseFloat(data[0].lon);
        viewer.camera.flyTo({
          destination: Cesium.Cartesian3.fromDegrees(lon, lat, 2000),
          orientation: { pitch: Cesium.Math.toRadians(-45) }
        });
        infoBox.innerHTML = `
          <strong>${query}</strong><br>
          <a href="https://www.google.com/search?q=${encodeURIComponent(query)}" target="_blank">
            Search on Google 🔎
          </a>
        `;
        infoBox.style.display = "block";
        loadingStatus.style.display = "none";
      } catch (error) {
        loadingStatus.textContent = "Error: Unable to complete the search.";
        console.error(error);
      }
    }
  </script>

</body>
</html>
