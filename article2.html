# ØªØ«Ø¨ÙŠØª Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨Ø¹ÙŠØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
!apt-get update
!apt-get install -y xvfb wget unzip libvulkan1 mesa-vulkan-drivers
!wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
!dpkg -i google-chrome-stable_current_amd64.deb || apt-get -y install -f
!pip install selenium pyvirtualdisplay fake_useragent undetected_chromedriver numpy chromedriver_autoinstaller requests

# ØªØ­Ø¯ÙŠØ« ChromeDriver
!wget https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/139.0.7258.66/linux64/chromedriver-linux64.zip
!unzip -o chromedriver-linux64.zip
!mkdir -p /usr/local/bin/
!mv chromedriver-linux64/chromedriver /usr/local/bin/
!chmod +x /usr/local/bin/chromedriver

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙˆØ§ÙÙ‚ Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª
import subprocess
try:
    chrome_version = subprocess.getoutput('google-chrome --version').split()[2]
    chromedriver_version = subprocess.getoutput('chromedriver --version').split()[1]
    print(f"âœ… Chrome version: {chrome_version}")
    print(f"âœ… ChromeDriver version: {chromedriver_version}")

    if chrome_version.split('.')[0] != chromedriver_version.split('.')[0]:
        raise Exception(f"Ø¥ØµØ¯Ø§Ø± Chrome ({chrome_version}) Ùˆ ChromeDriver ({chromedriver_version}) ØºÙŠØ± Ù…ØªÙˆØ§ÙÙ‚ÙŠÙ†!")
    else:
        print("âœ… Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª Ù…ØªÙˆØ§ÙÙ‚Ø©")
except Exception as e:
    print(f"âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª: {str(e)}")
    raise

import os
import time
import random
import string
import secrets
import threading
import logging
import numpy as np
import requests
import shutil
import zipfile
import json
import socket
import ipaddress
import concurrent.futures
from datetime import datetime
from pyvirtualdisplay import Display
import undetected_chromedriver as uc
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.common.keys import Keys
from selenium.common.exceptions import TimeoutException, WebDriverException, NoSuchElementException, StaleElementReferenceException, InvalidSessionIdException
from fake_useragent import UserAgent
import chromedriver_autoinstaller

# ØªØ­Ø¯ÙŠØ¯ Ù…Ø³Ø§Ø± Chrome Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠ
CHROME_BINARY_PATH = "/usr/bin/google-chrome"
CHROMEDRIVER_PATH = "/usr/local/bin/chromedriver"

# ====== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø²ÙŠÙ Ù„Ù…Ø­Ø§ÙƒØ§Ø© Windows ======
os.environ['XDG_SESSION_TYPE'] = 'windows'
os.environ['XDG_CURRENT_DESKTOP'] = 'Windows'
os.environ['XDG_SESSION_DESKTOP'] = 'windows'
os.environ['XDG_RUNTIME_DIR'] = '/tmp/runtime-root'

# Ù†Ø·Ø§Ù‚Ø§Øª Ø³ÙƒÙ†ÙŠØ© Ø£Ù…Ø±ÙŠÙƒÙŠØ© Ø´Ø§Ø¦Ø¹Ø© (Ø£Ù…Ø«Ù„Ø©)
RESIDENTIAL_RANGES = [
    ("24.0.0.0", "24.255.255.255"),   # Comcast Cable
    ("50.0.0.0", "50.255.255.255"),   # Comcast Cable
    ("71.0.0.0", "71.255.255.255"),   # AT&T
    ("96.0.0.0", "96.255.255.255"),   # Charter Spectrum
    ("98.0.0.0", "98.255.255.255"),   # AT&T
    ("99.0.0.0", "99.255.255.255"),   # AT&T
    ("174.0.0.0", "174.255.255.255"), # Cox Communications
    ("184.0.0.0", "184.255.255.255")  # Rogers / Spectrum
]

# ====================== Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ======================

# ØªÙˆÙ„ÙŠØ¯ Ø¹Ù†ÙˆØ§Ù† IP Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù…Ù† Ù†Ø·Ø§Ù‚
def random_ip_from_range(start_ip, end_ip):
    """ØªÙˆÙ„ÙŠØ¯ Ø¹Ù†ÙˆØ§Ù† IP Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù…Ù† Ù†Ø·Ø§Ù‚ Ù…Ø¹ÙŠÙ†"""
    start = int(ipaddress.IPv4Address(start_ip))
    end = int(ipaddress.IPv4Address(end_ip))
    return str(ipaddress.IPv4Address(random.randint(start, end)))

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ù„Ø¹Ù†ÙˆØ§Ù† Ø³Ø¬Ù„ DNS
def has_dns(ip):
    """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ù„Ø¹Ù†ÙˆØ§Ù† IP Ø³Ø¬Ù„ DNS Ù…Ø±ØªØ¨Ø·"""
    try:
        socket.setdefaulttimeout(1)
        socket.gethostbyaddr(ip)
        return True
    except:
        return False

# Ø¯Ø§Ù„Ø© Ù„Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹ Ø¹Ù† Ø¹Ù†ÙˆØ§Ù† IP Ù…Ø±ØªØ¨Ø·
def find_linked_ip():
    """Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹ Ø¹Ù† Ø¹Ù†ÙˆØ§Ù† IP Ù…Ø±ØªØ¨Ø· Ø¨Ø³Ø¬Ù„ DNS Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… multi-threading"""
    print("ğŸ” Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹ Ø¹Ù† Ø¹Ù†ÙˆØ§Ù† IP Ù…Ø±ØªØ¨Ø· Ø¨Ø³Ø¬Ù„ DNS...")
    
    with concurrent.futures.ThreadPoolExecutor(max_workers=200) as executor:
        futures = []
        for _ in range(500):  # Ø¥Ù†Ø´Ø§Ø¡ 500 Ù…Ù‡Ù…Ø© Ø¨Ø­Ø«
            ip_range = random.choice(RESIDENTIAL_RANGES)
            ip = random_ip_from_range(ip_range[0], ip_range[1])
            futures.append(executor.submit(has_dns, ip))
        
        for future in concurrent.futures.as_completed(futures):
            result = future.result()
            if result:
                ip = future.result.args[0] if hasattr(future.result, 'args') else "IP ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"
                print(f"âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† Ù…Ø±ØªØ¨Ø·: {ip}")
                return ip
    
    print("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† IP Ù…Ø±ØªØ¨Ø· Ø¨Ø¹Ø¯ 500 Ù…Ø­Ø§ÙˆÙ„Ø©")
    return None

# Ø¯Ø§Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆÙƒÙŠØ² ÙˆØ§Ù‚Ø¹ÙŠØ©
def generate_realistic_cookies(driver):
    """Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆÙƒÙŠØ² ÙˆØ§Ù‚Ø¹ÙŠØ© Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙÙ‚Ø· Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… JavaScript"""
    main_domain = "ghjs-89e.pages.dev"
    
    try:
        # Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.TAG_NAME, 'body')))
        
        # Ø­Ù‚Ù† Ø§Ù„ÙƒÙˆÙƒÙŠØ² Ø¹Ø¨Ø± JavaScript (ØªØ¬Ø§ÙˆØ² Ù‚ÙŠÙˆØ¯ Ø§Ù„Ù†Ø·Ø§Ù‚)
        cookies_js = f"""
        const mainDomain = ".pages.dev";
        const cookies = [
            {{
                name: '_ga', 
                value: `GA1.1.${{Math.floor(Math.random() * 10000000000) + 1000000000}}.${{Math.floor(Date.now()/1000)}}`, 
                path: '/', 
                domain: mainDomain,
                expires: new Date(Date.now() + 63072000000).toUTCString()
            }},
            {{
                name: 'consent', 
                value: 'true', 
                path: '/', 
                domain: mainDomain,
                expires: new Date(Date.now() + 31536000000).toUTCString()
            }},
            {{
                name: 'session_id', 
                value: Math.random().toString(36).substring(2, 18) + Math.random().toString(36).substring(2, 18), 
                path: '/', 
                domain: mainDomain,
                expires: new Date(Date.now() + 1800000).toUTCString()
            }},
            {{
                name: 'theme', 
                value: ['dark','light'][Math.floor(Math.random() * 2)], 
                path: '/', 
                domain: mainDomain,
                expires: new Date(Date.now() + 2592000000).toUTCString()
            }},
            {{
                name: 'country', 
                value: 'US', 
                path: '/', 
                domain: mainDomain,
                expires: new Date(Date.now() + 31536000000).toUTCString()
            }}
        ];
        
        cookies.forEach(cookie => {{
            document.cookie = `${{cookie.name}}=${{cookie.value}};path=${{cookie.path}};domain=${{cookie.domain}};expires=${{cookie.expires}};SameSite=Lax`;
        }});
        console.log(`ğŸª ØªÙ… Ø­Ù‚Ù† ${{cookies.length}} ÙƒÙˆÙƒÙŠ Ø¨Ù†Ø¬Ø§Ø­`);
        """
        
        driver.execute_script(cookies_js)
        print(f"ğŸª ØªÙ… Ø­Ù‚Ù† 5 ÙƒÙˆÙƒÙŠ Ù„Ù€ {main_domain} Ø¹Ø¨Ø± JavaScript")
        return True
        
    except Exception as e:
        print(f"âš ï¸ ÙØ´Ù„ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙˆÙƒÙŠØ²: {str(e)}")
        return False

# Ø¯Ø§Ù„Ø© Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§ÙˆØ³ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©
def simulate_human_mouse_movements(driver, element=None):
    """Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø±ÙƒØ§Øª Ù…Ø§ÙˆØ³ Ø¨Ø´Ø±ÙŠØ© Ø·Ø¨ÙŠØ¹ÙŠØ© Ù…Ø¹ ØªØ³Ø§Ø±Ø¹ ÙˆØªØ°Ø¨Ø°Ø¨"""
    try:
        actions = ActionChains(driver)
        
        # Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… ØªÙˆÙÙŠØ± Ø¹Ù†ØµØ±ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙˆÙ‚Ø¹ Ø¹Ø´ÙˆØ§Ø¦ÙŠ ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø©
        if element is None:
            window_size = driver.get_window_size()
            start_x = random.randint(0, window_size['width'])
            start_y = random.randint(0, window_size['height'])
        else:
            # Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù†ØµØ±
            driver.execute_script("arguments[0].scrollIntoView({behavior: 'smooth', block: 'center'});", element)
            time.sleep(0.3)
            
            # Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù†ØµØ±
            loc = element.location
            size = element.size
            start_x = loc['x'] + size['width']//2
            start_y = loc['y'] + size['height']//2
        
        # ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù…Ø§ÙˆØ³ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ÙˆÙ„ÙŠ Ø¨Ø³Ø±Ø¹Ø©
        actions.move_by_offset(start_x, start_y).perform()
        time.sleep(0.2)
        
        # Ø­Ø±ÙƒØ§Øª Ù…ØªØ¹Ø±Ø¬Ø© Ø¨Ø³Ø±Ø¹Ø§Øª Ù…ØªÙØ§ÙˆØªØ©
        for i in range(random.randint(3, 6)):
            # Ø­Ø±ÙƒØ© Ø¨Ø³Ø±Ø¹Ø© Ù…ØªØºÙŠØ±Ø© Ù…Ø¹ ØªØ³Ø§Ø±Ø¹
            x_offset = random.randint(-30, 30)
            y_offset = random.randint(-30, 30)
            
            # ØªØºÙŠÙŠØ± Ø§Ù„Ø³Ø±Ø¹Ø© Ø®Ù„Ø§Ù„ Ø§Ù„Ø­Ø±ÙƒØ©
            actions.move_by_offset(x_offset//3, y_offset//3).pause(0.05)
            actions.move_by_offset(x_offset//2, y_offset//2).pause(0.05)
            actions.move_by_offset(x_offset, y_offset).pause(0.1)
            
            # ØªØ°Ø¨Ø°Ø¨ ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø­Ø±ÙƒØ©
            for j in range(random.randint(1, 3)):
                actions.move_by_offset(random.randint(-3, 3), random.randint(-3, 3)).pause(0.05)
        
        # Ø­Ø±ÙƒØ© Ù†Ù‡Ø§Ø¦ÙŠØ© Ø³Ø±ÙŠØ¹Ø©
        actions.move_by_offset(random.randint(-15, 15), random.randint(-15, 15)).pause(0.1)
        
        # Ù†Ù‚Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ (40% Ø§Ø­ØªÙ…Ø§Ù„)
        if random.random() > 0.6:
            actions.click().pause(0.3)
            print("ğŸ–±ï¸ ØªÙ… Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø±ÙƒØ§Øª Ù…Ø§ÙˆØ³ Ù…Ø¹ Ù†Ù‚Ø±")
        else:
            print("ğŸ–±ï¸ ØªÙ… Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø±ÙƒØ§Øª Ù…Ø§ÙˆØ³")
        
        actions.perform()
        return True
        
    except Exception as e:
        print(f"âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§ÙˆØ³ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©: {str(e)}")
        return False

# Ø¯Ø§Ù„Ø© Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù„Ù…Ø³Ø§Øª Ø§Ù„Ø¨Ø´Ø±ÙŠØ©
def simulate_human_touches(driver, num_touches=3):
    try:
        # Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø´Ø§Ø´Ø©
        window_size = driver.get_window_size()
        width = window_size['width']
        height = window_size['height']
        
        # ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¢Ù…Ù†Ø© (70% Ù…Ù† Ù…Ù†ØªØµÙ Ø§Ù„Ø´Ø§Ø´Ø©)
        safe_area = {
            'min_x': int(width * 0.15),
            'max_x': int(width * 0.85),
            'min_y': int(height * 0.15),
            'max_y': int(height * 0.85)
        }
        
        for i in range(num_touches):
            # ØªÙˆÙ„ÙŠØ¯ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ø¶Ù…Ù† Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¢Ù…Ù†Ø©
            x = random.randint(safe_area['min_x'], safe_area['max_x'])
            y = random.randint(safe_area['min_y'], safe_area['max_y'])
            
            # Ø­Ø±ÙƒØ© Ù„Ù…Ø³Ø© Ø¨Ø´Ø±ÙŠØ© Ù…Ø¹ ØªØ°Ø¨Ø°Ø¨
            for j in range(3):
                offset_x = random.randint(-5, 5)
                offset_y = random.randint(-5, 5)
                driver.execute_script(f"""
                    var elem = document.elementFromPoint({x + offset_x}, {y + offset_y});
                    if (elem) {{
                        var event = new MouseEvent('mousemove', {{
                            'view': window,
                            'bubbles': true,
                            'cancelable': true,
                            'clientX': {x + offset_x},
                            'clientY': {y + offset_y}
                        }});
                        elem.dispatchEvent(event);
                    }}
                """)
                time.sleep(0.05)
            
            # Ø§Ø³ØªØ®Ø¯Ø§Ù… JavaScript Ù„Ù„Ù†Ù‚Ø±
            driver.execute_script(f"""
                var elem = document.elementFromPoint({x}, {y});
                if (elem) {{
                    var event = new MouseEvent('click', {{
                        'view': window,
                        'bubbles': true,
                        'cancelable': true
                    }});
                    elem.dispatchEvent(event);
                }}
            """)
            
            print(f"ğŸ‘† Ù„Ù…Ø³Ø© #{i+1}: ÙÙŠ ({x},{y})")
            time.sleep(random.uniform(0.8, 1.8))
            
        print(f"âœ… ØªÙ… ØªÙ†ÙÙŠØ° {num_touches} Ù„Ù…Ø³Ø§Øª Ø¨Ø´Ø±ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­")
        return True
        
    except Exception as e:
        print(f"âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù„Ù…Ø³ Ø§Ù„Ø¨Ø´Ø±ÙŠ: {str(e)}")
        return False

# Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø² Ù…Ù† User Agent
def detect_device_type(user_agent):
    if 'iPhone' in user_agent:
        return 'iphone'
    elif 'Android' in user_agent or 'Mobile' in user_agent:
        return 'mobile'
    else:
        return 'desktop'

# Ø¯Ø§Ù„Ø© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (ØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§)
def detect_and_interact_with_ads(driver):
    """Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙˆØ§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹Ù‡Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ‚Ù†ÙŠØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø©"""
    # ØªØ¹Ø±ÙŠÙ Ù…Ø­Ø¯Ø¯Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¯Ø§Ù„Ø©
    ad_selectors = [
        "div[id*='ad']", 
        "div[class*='ad']",
        "img[id*='ad']",
        "img[class*='ad']",
        "div[data-ad]",
        "div.ad-container",
        "a[href*='doubleclick']",
        "a[href*='googleadservices']"
    ]
    
    try:
        # Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (30 Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ø§Ø­ØªÙŠØ§Ø·)
        print("â³ Ø¬Ø§Ø± Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (30 Ø«Ø§Ù†ÙŠØ©)...")
        time.sleep(30)
        
        # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª
        frames = driver.find_elements(By.TAG_NAME, "iframe")
        print(f"ğŸ” ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ {len(frames)} Ø¥Ø·Ø§Ø±Ø§Øª")
        
        for frame in frames:
            try:
                driver.switch_to.frame(frame)
                # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
                for selector in ad_selectors:
                    try:
                        ads = driver.find_elements(By.CSS_SELECTOR, selector)
                        if ads:
                            ad = random.choice(ads)
                            print(f"ğŸŸ¢ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¥Ø¹Ù„Ø§Ù† Ø¯Ø§Ø®Ù„ Ø¥Ø·Ø§Ø±: {selector}")
                            
                            # Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
                            driver.execute_script("arguments[0].scrollIntoView({behavior: 'smooth', block: 'center'});", ad)
                            time.sleep(1)
                            
                            # Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø±ÙƒØ© Ù…Ø§ÙˆØ³ Ø¨Ø´Ø±ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ù†Ù‚Ø±
                            simulate_human_mouse_movements(driver, ad)
                            time.sleep(0.5)
                            
                            # Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
                            ad.click()
                            print("âœ… ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†!")
                            
                            # Ø§Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
                            ad_duration = random.randint(8, 20)
                            print(f"â±ï¸ Ø§Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù„Ù…Ø¯Ø© {ad_duration} Ø«Ø§Ù†ÙŠØ©")
                            time.sleep(ad_duration)
                            
                            # Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©
                            driver.switch_to.default_content()
                            return True
                    except:
                        continue
                driver.switch_to.default_content()
            except:
                driver.switch_to.default_content()
                continue
        
        # Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± ÙÙŠ Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª
        print("ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©...")
        for selector in ad_selectors:
            try:
                ads = driver.find_elements(By.CSS_SELECTOR, selector)
                if ads:
                    ad = random.choice(ads)
                    print(f"ğŸŸ¢ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¥Ø¹Ù„Ø§Ù† ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: {selector}")
                    
                    # Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
                    driver.execute_script("arguments[0].scrollIntoView({behavior: 'smooth', block: 'center'});", ad)
                    time.sleep(1)
                    
                    # Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø±ÙƒØ© Ù…Ø§ÙˆØ³ Ø¨Ø´Ø±ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ù†Ù‚Ø±
                    simulate_human_mouse_movements(driver, ad)
                    time.sleep(0.5)
                    
                    # Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
                    ad.click()
                    print("âœ… ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†!")
                    
                    # Ø§Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
                    ad_duration = random.randint(8, 20)
                    print(f"â±ï¸ Ø§Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù„Ù…Ø¯Ø© {ad_duration} Ø«Ø§Ù†ÙŠØ©")
                    time.sleep(ad_duration)
                    
                    return True
            except:
                continue
        
        print("â­ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª")
        return False
        
    except Exception as e:
        print(f"âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª: {str(e)}")
        return False

# Ø¯Ø§Ù„Ø© Ù„Ø­Ù‚Ù† Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª Ù…Ø®ØµØµØ© Ø­Ø³Ø¨ Ø§Ù„Ø¬Ù‡Ø§Ø²
def inject_stealth_script(driver, device_type):
    """Ø­Ù‚Ù† Ø³ÙƒØ±ÙŠØ¨Øª ØªØ®ÙÙŠ Ù…Ø®ØµØµ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²"""
    # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© (Ø£Ù…Ø±ÙŠÙƒÙŠØ© Ø£Ø³Ø§Ø³Ø§Ù‹)
    languages = ['en-US', 'en-GB', 'es-US', 'fr-CA']
    random_language = random.choice(languages)
    
    # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²
    if device_type == 'iphone':
        screen_width = 390
        screen_height = 844
        platform = 'iPhone'
        user_agent = f"Mozilla/5.0 (iPhone; CPU iPhone OS {random.randint(15, 16)}_{random.randint(0, 5)} like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/{random.randint(15, 16)}.0 Mobile/15E148 Safari/604.1"
    elif device_type == 'mobile':
        screen_width = 360
        screen_height = 740
        platform = 'Android'
        user_agent = f"Mozilla/5.0 (Linux; Android {random.randint(10, 12)}; SM-G9{random.randint(70, 99)} Build/PPR1.180610.011) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/{random.randint(90, 100)}.0.4430.210 Mobile Safari/537.36"
    else:  # desktop
        screen_width = 1366
        screen_height = 768
        platform = 'Win32'
        user_agent = f"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/{random.randint(90, 100)}.0.4389.114 Safari/537.36"
    
    stealth_script = f"""
    // ØªØºÙŠÙŠØ± Ø®ØµØ§Ø¦Øµ Ø§Ù„Ù…ØªØµÙØ­ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ÙƒØ´Ù
    Object.defineProperty(navigator, 'webdriver', {{
        get: () => undefined,
        configurable: true
    }});

    // ØªØºÙŠÙŠØ± Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…ØªØµÙØ­
    Object.defineProperty(navigator, 'appVersion', {{
        get: () => '{user_agent}',
        configurable: true
    }});

    // ØªØºÙŠÙŠØ± Ù„ØºØ© Ø§Ù„Ù…ØªØµÙØ­
    Object.defineProperty(navigator, 'languages', {{
        get: () => ['{random_language}'],
        configurable: true
    }});

    // ØªØºÙŠÙŠØ± Ù…Ù†ØµØ© Ø§Ù„Ù…ØªØµÙØ­
    Object.defineProperty(navigator, 'platform', {{
        get: () => '{platform}',
        configurable: true
    }});

    // Ø¥Ø¶Ø§ÙØ© Ø®ØµØ§Ø¦Øµ ÙˆÙ‡Ù…ÙŠØ© Ù„Ù…ØªØµÙØ­ Chrome
    window.chrome = {{
        runtime: {{}},
        app: {{
            isInstalled: false
        }},
        loadTimes: function() {{}},
        csi: function() {{}},
    }};

    // ØªØºÙŠÙŠØ± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©
    Object.defineProperty(navigator, 'geolocation', {{
        value: {{
            getCurrentPosition: (callback) => callback({{
                coords: {{
                    latitude: {random.uniform(37.0, 39.0)},
                    longitude: {random.uniform(-122.0, -77.0)},
                    accuracy: {random.randint(50, 150)}
                }}
            }})
        }},
        configurable: true
    }});

    // ØªØºÙŠÙŠØ± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø©
    Object.defineProperty(screen, 'width', {{ get: () => {screen_width} }});
    Object.defineProperty(screen, 'height', {{ get: () => {screen_height} }});
    Object.defineProperty(screen, 'colorDepth', {{ get: () => 24 }});

    // ØªØºÙŠÙŠØ± ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    Object.defineProperty(navigator, 'userAgent', {{
        get: () => '{user_agent}',
        configurable: true
    }});

    // Ø¥Ø®ÙØ§Ø¡ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„ Linux
    Object.defineProperty(navigator, 'oscpu', {{
        get: () => 'Windows NT 10.0',
        configurable: true
    }});
    
    // Ø¥Ø®ÙØ§Ø¡ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…
    Object.defineProperty(navigator, 'hardwareConcurrency', {{
        get: () => {random.randint(4, 8)},
        configurable: true
    }});
    
    // Ø¥Ø®ÙØ§Ø¡ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ù…
    Object.defineProperty(navigator, 'platform', {{
        get: () => 'Win32',
        configurable: true
    }});

    // Ø¥Ø®ÙØ§Ø¡ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª WebGL
    const getParameter = WebGLRenderingContext.prototype.getParameter;
    WebGLRenderingContext.prototype.getParameter = function(parameter) {{
        if (parameter === 37445) {{
            return 'Google Inc. (AMD)'; // Ù…Ø­Ø§ÙƒØ§Ø© Ø¨Ø·Ø§Ù‚Ø© AMD
        }}
        if (parameter === 37446) {{
            return 'ANGLE (AMD, AMD Radeon(TM) Graphics Direct3D11 vs_5_0 ps_5_0, D3D11)';
        }}
        return getParameter.call(this, parameter);
    }};

    console.log('âœ… ØªÙ… Ø­Ù‚Ù† Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„ØªØ®ÙÙŠ Ø¨Ù†Ø¬Ø§Ø­');
    """

    driver.execute_script(stealth_script)
    print("ğŸ”’ ØªÙ… Ø­Ù‚Ù† Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„ØªØ®ÙÙŠ Ø§Ù„Ù…Ø®ØµØµ Ù„Ù„Ø¬Ù‡Ø§Ø²")
    print(f"ğŸŒ Ù„ØºØ© Ø§Ù„Ù…ØªØµÙØ­: {random_language}")
    print(f"ğŸ“± ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: {user_agent}")

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ø¥Ø®ÙØ§Ø¡ Selenium
def get_stealth_options(user_agent, device_type):
    options = uc.ChromeOptions()
    options.binary_location = CHROME_BINARY_PATH

    # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© (Ø¨Ø¯ÙˆÙ† Ø­Ø¸Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª)
    options.add_argument("--no-sandbox")
    options.add_argument("--disable-dev-shm-usage")
    options.add_argument("--disable-gpu")
    options.add_argument("--ignore-certificate-errors")
    options.add_argument("--disable-infobars")
    options.add_argument("--disable-notifications")
    options.add_argument("--disable-blink-features=AutomationControlled")
    options.add_argument("--allow-running-insecure-content")
    options.add_argument("--no-default-browser-check")
    options.add_argument("--no-first-run")
    options.add_argument("--disable-logging")
    options.add_argument("--log-level=3")
    options.add_argument("--silent")
    options.add_argument("--mute-audio")
    options.add_argument("--no-zygote")
    
    # Ø¥Ø®ÙØ§Ø¡ Ø£ÙŠ Ø¥Ø´Ø§Ø±Ø© Ø¥Ù„Ù‰ Linux
    options.add_argument("--disable-linux-activation")
    options.add_argument("--disable-os-check")
    options.add_argument("--disable-setuid-sandbox")
    
    # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª DNS Ø®Ø§ØµØ© Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Cloudflare
    options.add_argument("--dns-server=1.1.1.1,1.0.0.1")  # Ø§Ø³ØªØ®Ø¯Ø§Ù… DNS Ù…Ù† Cloudflare
    options.add_argument("--host-resolver-rules=MAP * 0.0.0.0 , EXCLUDE ghjs-89e.pages.dev")
    
    # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    options.add_argument(f"--user-agent={user_agent}")

    # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø­Ø¬Ù… Ø§Ù„Ù†Ø§ÙØ°Ø©
    if device_type == 'mobile' or device_type == 'iphone':
        options.add_argument("--window-size=390,844")  # Ø­Ø¬Ù… Ø¬Ù‡Ø§Ø² Ø­Ø¯ÙŠØ«
    else:
        options.add_argument("--window-size=1200,800")  # Ø­Ø¬Ù… Ù…Ø¹Ù‚ÙˆÙ„ Ù„Ù„Ø´Ø§Ø´Ø§Øª

    # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„ØºØ© ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ (Ø£Ù…Ø±ÙŠÙƒÙŠØ©)
    options.add_argument("--lang=en-US")
    options.add_argument("--accept-lang=en-US,en;q=0.9")

    # ØªÙ…ÙƒÙŠÙ† WebGL ÙˆØ®ØµØ§Ø¦Øµ Ù…ØªÙ‚Ø¯Ù…Ø©
    options.add_argument("--enable-webgl")
    options.add_argument("--enable-3d-apis")
    options.add_argument("--enable-accelerated-2d-canvas")
    
    # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„Ù…Ø­Ø§ÙƒØ§Ø© Windows
    options.add_argument("--disable-features=LinuxObsoleteSystem")
    options.add_argument("--disable-backing-store-limit")
    options.add_argument("--disable-accelerated-video-decode")
    options.add_argument("--disable-accelerated-video-encode")
    
    # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ®ÙÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
    options.add_argument("--disable-blink-features=AutomationControlled")
    
    return options

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
def check_internet_connection():
    """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡"""
    print("ğŸ” Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª...")
    try:
        response = requests.get("https://www.google.com", timeout=10)
        if response.status_code == 200:
            print("âœ… Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ù†Ø´Ø·")
            return True
    except:
        pass
    
    print("âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª")
    return False

# ====================== Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù…Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª ======================

def run_bot(bot_num, thread_num):
    print(f"\n{'='*50}")
    print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ¤– Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª #{bot_num}")
    print(f"{'='*50}")
    
    display = None
    driver = None
    
    # Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù„Ø¯ Ù„Ø­ÙØ¸ Ù„Ù‚Ø·Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø©
    screenshot_folder = f"screenshots/bot_{bot_num}"
    os.makedirs(screenshot_folder, exist_ok=True)
    
    try:
        # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
        if not check_internet_connection():
            print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¨Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª")
            return False
        
        # Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø±Ø¶ Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø®Ø§Øµ Ø¨Ø§Ù„Ø®ÙŠØ· - Ù…Ø­Ø§ÙƒØ§Ø© Windows
        display = Display(visible=0, size=(1200, 800), backend="xvfb", use_xauth=True)
        display.start()
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | âœ… Ø¨Ø¯Ø£ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ (Ù…Ø®ÙÙŠ)")
        
        # Ø¥Ù†Ø´Ø§Ø¡ ÙˆÙƒÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø´ÙˆØ§Ø¦ÙŠ
        ua = UserAgent()
        user_agent = ua.random
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸŒ User-Agent: {user_agent}")

        # ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²
        device_type = detect_device_type(user_agent)
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ“± Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²: {device_type}")

        # Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† IP Ù…Ø±ØªØ¨Ø·
        valid_ip = find_linked_ip()
        
        # Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† IP ØµØ§Ù„Ø­
        if valid_ip is None:
            print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù† IP Ù…Ø±ØªØ¨Ø·")
            return False
        
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¹Ù†ÙˆØ§Ù† IP Ù…Ø±ØªØ¨Ø·: {valid_ip}")

        # Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„Ù…ØªØ®ÙÙŠØ©
        options = get_stealth_options(user_agent, device_type)

        # Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ØªØµÙØ­
        driver = uc.Chrome(
            options=options,
            headless=False,
            use_subprocess=True,
            browser_executable_path=CHROME_BINARY_PATH,
            driver_executable_path=CHROMEDRIVER_PATH
        )
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸš€ Ø¨Ø¯Ø£ ØªØ´ØºÙŠÙ„ Ù…ØªØµÙØ­ Chrome Ø§Ù„Ù…ØªØ®ÙÙŠ")

        # Ø­Ù‚Ù† Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„ØªØ®ÙÙŠ Ø§Ù„Ù…Ø®ØµØµ Ù„Ù„Ø¬Ù‡Ø§Ø²
        inject_stealth_script(driver, device_type)
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ”’ ØªÙ… ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ù…ØªØµÙØ­ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„")

        # Ø¥Ø¶Ø§ÙØ© ØªØ±ÙˆÙŠØ³Ø§Øª Ù…Ø®ØµØµØ©
        driver.execute_cdp_cmd("Network.enable", {})
        driver.execute_cdp_cmd("Network.setExtraHTTPHeaders", {
            "headers": {
                "Host": "ghjs-89e.pages.dev",  # Ø¥Ø¶Ø§ÙØ© ØªØ±ÙˆÙŠØ³Ø© Host Ø§Ù„ØµØ­ÙŠØ­Ø©
                "X-Forwarded-For": valid_ip,
                "X-Real-IP": valid_ip,
                "Client-IP": valid_ip,
                "CF-Connecting-IP": valid_ip,
                "Forwarded": f"for={valid_ip};proto=https",
                "Via": f"1.1 {valid_ip}",
                "X-Proxy-IP": valid_ip,
                "Accept-Language": "en-US,en;q=0.9",
                "Sec-Fetch-Dest": "document",
                "Sec-Fetch-Mode": "navigate",
                "Sec-Fetch-Site": "none",
                "Sec-Fetch-User": "?1",
                "Upgrade-Insecure-Requests": "1"
            }
        })

        # Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆÙƒÙŠØ² ÙˆØ§Ù‚Ø¹ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø­Ù„ Ø§Ù„Ø°ÙƒÙŠ
        generate_realistic_cookies(driver)
        
        # Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù…Ø¹ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
        main_url = "https://ghjs-89e.pages.dev"  # ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¥Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ØµØ­ÙŠØ­
        max_attempts = 3
        for attempt in range(max_attempts):
            try:
                print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ” Ø¬Ø§Ø± ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© {attempt+1}): {main_url}")
                driver.get(main_url)
                # Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø³Ù… Ù…Ø¹ Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ù‡Ù„Ø©
                WebDriverWait(driver, 60).until(EC.presence_of_element_located((By.CSS_SELECTOR, "body")))
                print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ù†Ø¬Ø§Ø­")
                break
            except Exception as e:
                print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | âš ï¸ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹: {str(e)}")
                if attempt < max_attempts - 1:
                    wait_time = 10
                    print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | â±ï¸ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¹Ø¯ {wait_time} Ø«ÙˆØ§Ù†ÙŠ...")
                    time.sleep(wait_time)
                else:
                    print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø¹Ø¯ {max_attempts} Ù…Ø­Ø§ÙˆÙ„Ø§Øª")
                    return False
        
        # Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        driver.save_screenshot(f'{screenshot_folder}/1_main_page_loaded.png')
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ“¸ Ù„Ù‚Ø·Ø© Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©")
        
        # Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ù†ØªØ¸Ø§Ø± 20 Ø«Ø§Ù†ÙŠØ© Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | â±ï¸ Ø§Ù†ØªØ¸Ø§Ø± 20 Ø«Ø§Ù†ÙŠØ© Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰...")
        time.sleep(20)
        
        # Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙˆØ§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹Ù‡Ø§
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ” Ø¬Ø§Ø± Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª...")
        ad_detected = detect_and_interact_with_ads(driver)
        
        if ad_detected:
            # Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
            driver.save_screenshot(f'{screenshot_folder}/2_after_ad_click.png')
            print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ“¸ Ù„Ù‚Ø·Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†")
        else:
            print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | â„¹ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª")
        
        # Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± "Let's go" (ØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡)
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø²Ø± 'Let's go'")
        button_found = False
        
        # Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ù„Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±
        for attempt in range(7):  # Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø¥Ù„Ù‰ 7
            try:
                # Ø§Ø³ØªØ®Ø¯Ø§Ù… JavaScript Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø²Ø±
                button = driver.execute_script("""
                    const buttons = Array.from(document.querySelectorAll('button, a, div, input[type="button"]'));
                    const targetButtons = buttons.filter(btn => 
                        (btn.innerText || btn.textContent || btn.getAttribute('aria-label') || '').toLowerCase().includes('go') || 
                        (btn.innerText || btn.textContent || btn.getAttribute('aria-label') || '').toLowerCase().includes('start') ||
                        (btn.innerText || btn.textContent || btn.getAttribute('aria-label') || '').toLowerCase().includes('lets go') ||
                        (btn.innerText || btn.textContent || btn.getAttribute('aria-label') || '').toLowerCase().includes('begin') ||
                        (btn.innerText || btn.textContent || btn.getAttribute('aria-label') || '').toLowerCase().includes('play')
                    );
                    return targetButtons.length > 0 ? targetButtons[0] : null;
                """)
                
                if button:
                    # Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ù‚Ø¨Ù„ Ø§Ù„Ù†Ù‚Ø±
                    driver.save_screenshot(f'{screenshot_folder}/3_before_click_go_button.png')
                    print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ“¸ Ù„Ù‚Ø·Ø© Ù‚Ø¨Ù„ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±")
                    
                    # Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø±ÙƒØ© Ù…Ø§ÙˆØ³ Ø¨Ø´Ø±ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ù†Ù‚Ø±
                    simulate_human_mouse_movements(driver, button)
                    time.sleep(0.5)
                    
                    # Ø§Ù„Ù†Ù‚Ø± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… JavaScript
                    driver.execute_script("arguments[0].click();", button)
                    print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ–±ï¸ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± 'Let's go'")
                    button_found = True
                    break
                else:
                    print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | âš ï¸ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© {attempt+1}: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±")
            except Exception as e:
                print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±: {str(e)}")
            
            time.sleep(2)
        
        if not button_found:
            print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø²Ø± 'Let's go'")
            # Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©
            driver.save_screenshot(f'{screenshot_folder}/button_not_found.png')
            print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ“¸ ØªÙ… Ø­ÙØ¸ Ù„Ù‚Ø·Ø© Ù„Ù„ØµÙØ­Ø© Ù„ÙØ­Øµ Ø§Ù„Ø²Ø±")
        
        # Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        time.sleep(5)
        
        # Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        driver.save_screenshot(f'{screenshot_folder}/4_second_page_loaded.png')
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ“¸ Ù„Ù‚Ø·Ø© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©")
        
        # Ø§Ù„Ø®Ø·ÙˆØ© 4: Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø³Ù„ÙˆÙƒÙŠØ§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ” Ø¨Ø¯Ø¡ Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø³Ù„ÙˆÙƒÙŠØ§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©")
        
        # Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¨Ø´Ø±ÙŠ
        for _ in range(random.randint(3, 5)):
            scroll_amount = random.randint(300, 800)
            scroll_time = random.uniform(0.8, 2.0)
            driver.execute_script(f"window.scrollBy(0, {scroll_amount})")
            time.sleep(scroll_time)
            
            # Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¹ÙƒØ³ÙŠ Ø£Ø­ÙŠØ§Ù†Ø§Ù‹
            if random.random() > 0.7:
                reverse_amount = random.randint(100, 300)
                driver.execute_script(f"window.scrollBy(0, {-reverse_amount})")
                time.sleep(scroll_time/2)
        
        # Ù…Ø­Ø§ÙƒØ§Ø© Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§ÙˆØ³ Ø£Ùˆ Ø§Ù„Ù„Ù…Ø³Ø§Øª
        if device_type == 'desktop':
            simulate_human_mouse_movements(driver)
        elif device_type == 'mobile' or device_type == 'iphone':
            simulate_human_touches(driver, random.randint(2, 3))
        
        # Ø§Ù„Ø®Ø·ÙˆØ© 5: Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ” Ø¬Ø§Ø± Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©...")
        detect_and_interact_with_ads(driver)
        
        # Ø§Ù†ØªØ¸Ø§Ø± 10-15 Ø«Ø§Ù†ÙŠØ© Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ
        wait_time = random.uniform(10, 15)
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | â±ï¸ Ø§Ù†ØªØ¸Ø§Ø± {wait_time:.1f} Ø«Ø§Ù†ÙŠØ© ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©...")
        time.sleep(wait_time)
        
        # Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ù†Ù‡Ø§Ø¦ÙŠØ©
        driver.save_screenshot(f'{screenshot_folder}/5_final_page.png')
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ“¸ Ù„Ù‚Ø·Ø© Ù†Ù‡Ø§Ø¦ÙŠØ©")

        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | âœ… Ø§ÙƒØªÙ…Ù„ Ø§Ù„Ø¨ÙˆØª #{bot_num} Ø¨Ù†Ø¬Ø§Ø­")
        return True

    except Exception as e:
        print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙˆØª #{bot_num}: {str(e)}")
        try:
            driver.save_screenshot(f'{screenshot_folder}/error.png')
            print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ“¸ ØªÙ… Ø­ÙØ¸ Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© Ù„Ù„Ø®Ø·Ø£")
        except:
            pass
        return False
    finally:
        try:
            if driver:
                driver.quit()
                print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ”´ ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ØªØµÙØ­")
        except:
            pass
        try:
            if display:
                display.stop()
                print(f"ğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} | ğŸ”´ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ")
        except:
            pass

# Ø¯Ø§Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ø¶ØºÙˆØ· Ù…Ù† Ø§Ù„Ù„Ù‚Ø·Ø§Øª
def create_screenshots_zip():
    zip_filename = "screenshots.zip"
    
    # Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ø¶ØºÙˆØ· Ø¬Ø¯ÙŠØ¯
    with zipfile.ZipFile(zip_filename, 'w', zipfile.ZIP_DEFLATED) as zipf:
        # Ø¥Ø¶Ø§ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„Ù‚Ø·Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø¶ØºÙˆØ·
        for root, dirs, files in os.walk("screenshots"):
            for file in files:
                file_path = os.path.join(root, file)
                zipf.write(file_path, os.path.relpath(file_path, "screenshots"))
    
    print(f"ğŸ“¦ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ø¶ØºÙˆØ·: {zip_filename}")
    return zip_filename

# ====================== ØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ======================

# Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù„Ù‚Ø·Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
os.makedirs("screenshots", exist_ok=True)

# Ø·Ù„Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø¨ÙˆØªØ§Øª ÙˆØ§Ù„Ø®ÙŠÙˆØ· Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
num_bots = int(input("â¬‡ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ ØªØ´ØºÙŠÙ„Ù‡Ø§: "))
num_threads = int(input("â¬‡ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø®ÙŠÙˆØ· (Threads) Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§: "))
print(f"ğŸš€ Ø³ÙŠØªÙ… ØªØ´ØºÙŠÙ„ {num_bots} Ø¨ÙˆØª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… {num_threads} Ø®ÙŠØ·")

# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØªØ§Øª ÙÙŠ Ø®ÙŠÙˆØ· Ù…ØªØ¹Ø¯Ø¯Ø©
successful_bots = 0
bot_counter = 1
threads = []

# ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¨ÙˆØªØ§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø®ÙŠÙˆØ· Ù…Ø¹ Ø§Ù„ÙØ§ØµÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠ
print(f"\nğŸ“Š ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¨ÙˆØªØ§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø®ÙŠÙˆØ·:")
print(f"  - Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„Ø¨ÙˆØªØ§Øª: {num_bots}")
print(f"  - Ø¹Ø¯Ø¯ Ø§Ù„Ø®ÙŠÙˆØ·: {num_threads}")

# Ù‚Ø§Ø¦Ù…Ø© Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø®ÙŠÙˆØ· Ø§Ù„Ù†Ø´Ø·Ø©
active_threads = []

# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®ÙŠÙˆØ· Ù…Ø¹ Ø§Ù„ÙØ§ØµÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ
for thread_num in range(1, num_threads + 1):
    # ØªØ®Ø·ÙŠ Ø§Ù„Ø®ÙŠÙˆØ· Ø§Ù„Ø²Ø§Ø¦Ø¯Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¨ÙˆØªØ§Øª Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø®ÙŠÙˆØ·
    if bot_counter > num_bots:
        break
        
    print(f"\nğŸ§µ Ø¨Ø¯Ø¡ Ø§Ù„Ø®ÙŠØ· #{thread_num} Ù„Ù„Ø¨ÙˆØª #{bot_counter}")
    
    # Ø¥Ù†Ø´Ø§Ø¡ Ø®ÙŠØ· Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¨ÙˆØª
    t = threading.Thread(target=run_bot, args=(bot_counter, thread_num))
    threads.append(t)
    active_threads.append(t)
    t.start()
    
    # Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙˆØª
    bot_counter += 1
    
    # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø®ÙŠØ± Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 5-12 Ø«ÙˆØ§Ù†ÙŠ Ù‚Ø¨Ù„ Ø¨Ø¯Ø¡ Ø§Ù„Ø®ÙŠØ· Ø§Ù„ØªØ§Ù„ÙŠ
    if thread_num < num_threads and bot_counter <= num_bots:
        delay = random.randint(5, 12)
        print(f"â±ï¸ ØªØ£Ø®ÙŠØ± Ù„Ù…Ø¯Ø© {delay} Ø«ÙˆØ§Ù†ÙŠ Ù‚Ø¨Ù„ Ø¨Ø¯Ø¡ Ø§Ù„Ø®ÙŠØ· Ø§Ù„ØªØ§Ù„ÙŠ")
        time.sleep(delay)

# Ù…ØªØ§Ø¨Ø¹Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© ÙÙŠ Ø§Ù„Ø®ÙŠÙˆØ· Ø§Ù„Ø­Ø§Ù„ÙŠØ©
while bot_counter <= num_bots:
    # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø®ÙŠØ· Ø§Ù†ØªÙ‡Ù‰ Ù…Ù† Ø¹Ù…Ù„Ù‡
    for i, t in enumerate(active_threads):
        if not t.is_alive():
            # Ù‡Ø°Ø§ Ø§Ù„Ø®ÙŠØ· Ø§Ù†ØªÙ‡Ù‰ØŒ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„Ø¨ÙˆØª Ø¬Ø¯ÙŠØ¯
            thread_num = i + 1
            print(f"\nğŸ§µ Ø§Ù„Ø®ÙŠØ· #{thread_num} Ù…ØªØ§Ø­ Ø§Ù„Ø¢Ù† Ù„Ù„Ø¨ÙˆØª #{bot_counter}")
            
            # Ø¥Ù†Ø´Ø§Ø¡ Ø®ÙŠØ· Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ù†ÙØ³ ÙÙ‡Ø±Ø³ Ø§Ù„Ø®ÙŠØ·
            t = threading.Thread(target=run_bot, args=(bot_counter, thread_num))
            threads.append(t)
            active_threads[i] = t
            t.start()
            
            # Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙˆØª
            bot_counter += 1
            
            # Ø¥Ø¶Ø§ÙØ© ØªØ£Ø®ÙŠØ± Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 5-12 Ø«ÙˆØ§Ù†ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø¨ÙˆØª Ø§Ù„ØªØ§Ù„ÙŠ
            if bot_counter <= num_bots:
                delay = random.randint(5, 12)
                print(f"â±ï¸ ØªØ£Ø®ÙŠØ± Ù„Ù…Ø¯Ø© {delay} Ø«ÙˆØ§Ù†ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø¨ÙˆØª Ø§Ù„ØªØ§Ù„ÙŠ")
                time.sleep(delay)
            
            break

# Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù†ØªÙ‡Ø§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®ÙŠÙˆØ·
for t in threads:
    t.join()

# Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ø¶ØºÙˆØ· Ù„Ù„Ù‚Ø·Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø©
zip_filename = create_screenshots_zip()

print("\n" + "="*60)
print(f"âœ… Ø§ÙƒØªÙ…Ù„ ØªØ´ØºÙŠÙ„ {num_bots} Ø¨ÙˆØª ÙÙŠ {num_threads} Ø®ÙŠØ·")
print("="*60)

# ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„Ù‚Ø·Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
try:
    from google.colab import files
    print("\nâ¬‡ï¸ Ø¬Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ù„Ù‚Ø·Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø©...")
    files.download(zip_filename)
    print("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„Ù‚Ø·Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!")
except:
    print("\nâŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ¦Ø© Google Colab")
    print(f"ğŸ“ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù„Ù‚Ø·Ø§Øª ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù…Ù†: {os.path.abspath(zip_filename)}")

# Ø±Ø§Ø¨Ø· Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±
print("\nÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„Ù‚Ø·Ø§Øª:")
print(f'''
from google.colab import files
files.download('{zip_filename}')
''')
